### 什么市场热key
热key问题就是, 突然有几十万的请求去访问Redis上的某个特定key. 那么,这样会造成流量过于集中, 达到物理网卡上线, 从而导致这台热Redis 的服务器宕机

### 怎么发现热key
方法一: 凭借业务经验, 进行预估那些是热key
    并不是所有业务都可以预估出那些key 是热key

方法二: 在客户端进行收集
这个方式就是在操作Redis之前, 加入一行代码进行数据统计. 那么这个数据系统的方式有很多种, 也可以给外部的通讯系统发送一个通知信息, 缺点就是对客户端代码造成入侵

方法三: 在proxy层做收集
有些集群架构是下面这样的, Proxy可以是Twemproxy, 是统一的入口. 可以在proxy层上收集上报, 但是缺点很明显,并非所有的Redis集群架构都有proxy.

方法四: 用Redis自带的命令
monitor命令,该命令可以实时抓取Redis服务器接受到的命令, 然后写代码统计出热key是啥. 当然. 也有现成的分析工具可以给你使用, 比如redis-faina, 但是该命令在高并发的条件下, 有内存爆增的隐患,还会减低Redis性能

方法五: 自己抓包评估
Redis客户端使用tcp协议与服务端进行交互, 通讯协议采用的是resp, 自己写程序监听端口, 按照resp协议规则解析数据, 进行分析. 确定就是开发成本高,维护困难, 有丢包可能性

### 解决方案
1. 对特定key或slot做限流
2. 使用二级（本地）缓存
3. 拆key
4. 本地缓存的另外一种思路 配置中心
5. 其他可以提前做的预案

### 整合方案
目前市面上已经有了不少关于hotKey相对完整的应用级解决方案，其中京东在这方面有开源的hotkey工具，原理就是在client端做洞察，然后上报对应hotkey，server端检测到后，将对应hotkey下发到对应服务端做本地缓存，并且这个本地缓存在远程对应的key更新后，会同步更新，已经是目前较为成熟的自动探测热key、分布式一致性缓存解决方案，京东零售热key。

![](https://img-blog.csdnimg.cn/8e693026e4c5480da4166ee7cdc35361.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5pyA54ix5b2p6Jm557OW,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center)
