1. 海量数据查询优化思路：
    如果每天有几百万条数据，一个月就是几千万了，有没有对于查询做一些优化喃？

    面试官预期：1. 考察对分库分表，高并发系统设计的理解，是否有真实高并发项目开发经验。
                2. 了解面试者对中间件的理解，市场主流中间键的优缺点，以及如何选择。

    场景： 注册用户20万，每天活跃用户在1万左右，每天表单数据量也就1000左右，高峰期的每秒钟的并发请求最多就10个；



          注册用户达到了2000万，每天活跃用户数量达到了100万，每天的表单数据量10万条，高峰期每秒请求并发量最大1000；


          每天多达10万条数据，一个月就多300万条，单表已经马上破千万了，勉强撑着。高峰期请求达1000；

          单表总数据量达到了五六千万，DBDB磁盘容量，不断消耗！ 高峰期并发量达到5000-8000！ 系统以及挂掉了。

        单表在几百万的时候，性能下降，我们就需要进行分表。
        库在并发在2000左右进行扩容，健康的数据库并发量大概在1000左右。

2. 问题： 
    1. 为什么要分库分表（设计高并发系统的时候，数据库层面该如何设计）？
        单个表的数据量过大，水平拆分，垂直拆分。 %10=0 , %10=1 ... 
    2. 用过哪些分库分表的中间件，不同的分库分表的中间件，都有哪些优点和缺点 ？
        比较常用的分库分表的中间件：Cobar(阿里B2B团队，最近更新的少，社区被抛弃)/ TDDL（淘宝团队开发，基于CRUD，不支持Join，多表查询）/ Atlas（代理层，社区抛弃）/ sharding-jdbc，分库分表，读写分离，TCC事务，使用方便，社区活跃/ mycat， 基于Cobar改造的，代理层的解决方案。/

    3. 你们具体是如何对数据库，进行垂直拆分或水平拆分的 ？

    4. 分库分表应该考虑哪些技术：
        分片键与分片规则的问题；

        如何避免所有库扫描的问题；
    
        分库分表中间件选型问题；

        分布式全局唯一ID问题；

        跨库join问题；
            考虑全局表字段的冗余，定时数据同步，系统层的组装。
        跨库事物的问题（XA, TCC）；
            跨分片事物的问题。
        跨库排序，分页问题；
            一般来说，分页按照指定字段排序，排序字段是分片字段，我们可以通过分片规则定位到指定字段，当排序字段非分配字段时，为了结果唯一性，需要从分片节点当中将数据进行排序，进行排序并返回。，
        数据迁移扩容的问题；

        小结： Sharding-jdbc 这种client层方案的优化在于，不用部署，运维成本低，不需要代理层的二次转发请求，性能很高，但是如果升级啥的需要，各个系统 重新升级再发布，各个系统都需要耦合Sharding-jdbc的依赖；
                MyCat这种proxy层方案的缺点在于需要部署，自己运维一套中间件，运维成本高，好处在于对于各个项目透明，如果遇到升级之类的，都是自己中间键那里搞就行了。

    5. 索引的种类：
        按数据结构分类：B+tree索引、Hash索引、Full-text索引。

        按物理存储分类：聚集索引、非聚集索引（也叫二级索引、辅助索引）。

        按字段特性分类：主键索引(PRIMARY KEY)、唯一索引(UNIQUE)、普通索引(INDEX)、全文索引(FULLTEXT)。
        
        按字段个数分类：单列索引、联合索引（也叫复合索引、组合索引）。

3. 创建索引几大原则
        1. 最左匹配原则
        2. =和in可以乱序
        3. 尽量选择区分度高的列作为索引
        4. 索引列不能参与计算，保持干净
        5. 尽量的扩展索引，不要新键一个索引
        