### 1. 隐藏索引
    mysql 8.0 新增 隐藏索引的功能， 相当于对与索引添加了一个回收站
    我们可以对索引设置 invisible， 该标识会使优化器对该索引不可见
    
    alter table user add index 'index_age'(age) invisible;

    alter table user alter index 'index_age' visible

### 2. 降序索引
    索引按照从大小的方式进行排序， 之前默认是按照升序的方式进行排序。


### 3. 窗口函数
1. 窗口函数在其他地方也叫分析函数
2. 窗口的概念非常重要，它可以理解为记录集合，窗口函数也就是在满足某种条件的记录集合上执行的特殊函数对于每条记录都要在此窗口内执行函数，有的函数随着记录不同，窗口大小都是固定的，这种属于静态窗口；有的函数则相反，不同的记录对应着不同的窗口，这种动态变化的窗口叫滑动窗口。简单的说窗口函数就是对于查询的每一行，都使用与该行相关的行进行计算
3. 窗口函数也叫OLAP函数(Online Analytical Processing,联机分析处理)，可以对数据进行实时分析处理。窗口函数和group by有类似之处，其区别在于窗口会对每个分组之后的数据进行分别操作，而group by一般对分组之后的函数使用聚集函数汇总。


2.窗口函数和普通聚合函数的区别

①聚合函数是将多条记录聚合为一条；窗口函数是每条记录都会执行，有几条记录执行完还是几条。

②聚合函数也可以用于窗口函数。

![常见的窗口函数](https://pics4.baidu.com/feed/9213b07eca806538ac761de88addbe4eac3482b3.png@f_auto?token=8075a7c949de1170fce9e4d9ee1b8439)

将上述函数按照功能划分，可以把MySQL支持的窗口函数分为如下几类：

序号函数：ROW_NUMBER()、RANK()、DENSE_RANK()

分布函数：PERCENT_RANK()、CUME_DIST()

前后函数：LAG()、LEAD()

头尾函数：FIRST_VALUE()、LAST_VALUE()

其它函数：NTH_VALUE()、NTILE()

### 窗口函数的使用
窗口函数的一个概念是当前行，当前行属于某个窗口，窗口由over关键字用来指定函数执行的窗口范围，如果后面括号中什么都不写，则意味着窗口包含满足where条件的所有行，窗口函数基于所有行进行计算；如果不为空，则有三个参数来设置窗口：

partition by子句：按照指定字段进行分区，两个分区由边界分隔，窗口函数在不同的分区内分别执行，在跨越分区边界时重新初始化。

order by子句：按照指定字段进行排序，窗口函数将按照排序后的记录顺序进行编号。可以和partition by子句配合使用，也可以单独使用。

frame子句：当前分区的一个子集，用来定义子集的规则，通常用来作为滑动窗口使用。

https://baijiahao.baidu.com/s?id=1728966619393719484&wfr=spider&for=pc